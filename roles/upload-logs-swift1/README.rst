Upload logs to a swift container

This uploads logs to an OpenStack Object Store (Swift) container.

**Role Variables**

.. zuul:rolevar:: zuul_site_upload_logs
   :default: true

   Controls when logs are uploaded. true, the default, means always
   upload logs. false means never upload logs. 'failure' means to only
   upload logs when the job has failed.

   .. note:: Intended to be set by admins via site-variables.

.. zuul:rolevar:: zuul_log_cloud_config

   Complex argument which contains the cloud configuration in
   os-cloud-config (clouds.yaml) format.  It is expected that this
   argument comes from a `Secret`.

.. zuul:rolevar:: zuul_log_partition
   :default: false

   If set to true, then the first component of the log path will be
   removed from the object name and added to the container name, so
   that logs for different changes are distributed across a large
   number of containers.

.. zuul:rolevar:: zuul_log_container
   :default: logs

   This role will create containers which do not already exist.  If
   partitioning is not enabled, this is the name of the container
   which will be used.  If partitioning is enabled, then this will be
   used as the prefix for the container name which will be separated
   from the partition name by an underscore.  For example, "logs_42"
   would be the container name for partition 42.

   Note that you will want to set this to a value that uniquely
   identifies your Zuul installation if using shared object stores that
   require globally unique container names. For example if using a
   public cloud whose Swift API is provided by Ceph.

.. zuul:rolevar:: zuul_log_container_public
   :default: true

   If the container is created, should it be created with global read
   ACLs.  If the container already exists, it will not be modified.

.. zuul:rolevar:: zuul_log_delete_after
   :default: 15552000

   Number of seconds to delete objects after upload. Default is 6 months
   (15552000 seconds) and if set to 0 X-Delete-After will not be set.

.. zuul:rolevar:: zuul_log_path
   :default: Generated by the role `set-zuul-log-path-fact`

   Prepend this path to the object names when uploading.

.. zuul:rolevar:: zuul_log_create_indexes
   :default: true

   Whether to create `index.html` files with directory indexes.  If set
   to false, Swift containers can be marked with a `Web-Listings=true`
   property to activate Swift's own directory indexing.

.. zuul:rolevar:: zuul_log_path_shard_build
   :default: False

   This var is consumed by set-zuul-log-path-fact which upload-logs-swift
   calls into. If you set this you will get log paths prefixed with the
   first three characters of the build uuid. This will improve log file
   sharding.

   More details can be found at
   :zuul:rolevar:`set-zuul-log-path-fact.zuul_log_path_shard_build`.

.. zuul:rolevar:: zuul_log_storage_proxy_url

   The url of the proxy for the cloud object store.
   If you are using zuul-storage-proxy to proxy requests for logs, set this
   to the the URL of the log proxy server.  When set, this role will replace
   the cloud storage endpoint with this value in the log URL returned to Zuul.

**Return Values**

.. zuul:rolevar:: zuul_upload_logs_results

   Information about the zuul log storage.

   .. zuul:rolevar:: url

      The full url of the log files which users can consume to get.
      If zuul_log_storage_proxy_url is set, the endpoint is replaced with that.

   .. zuul:rolevar:: endpoint

      The storage endpoint which is used to upload log files.

   .. zuul:rolevar:: path

      The path of log files in the storage.
